(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5267],{39548:function(e,t,r){Promise.resolve().then(r.bind(r,20173))},20173:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ea}});var n=r(41922),l=r(91115);let i=["#2563eb","#f97316","#10b981","#a855f7","#ec4899","#facc15","#14b8a6","#f43f5e","#0ea5e9","#22c55e"],s="#64748b";function o(e,t){var r;return null!==(r=null==t?void 0:t.iterations)&&void 0!==r?r:Math.min(280,Math.max(120,4*e))}function a(e){let t=new Map,r=0;for(let n of e){let e=n.division&&n.division.trim().length>0?n.division.trim():null;!e||t.has(e)||(t.set(e,i[r%i.length]),r+=1)}return t}function d(e,t,r){let n,l,i;if(0===t)n=l=i=r;else{let s=(e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e,o=r<.5?r*(1+t):r+t-r*t,a=2*r-o;n=s(a,o,e/360+1/3),l=s(a,o,e/360),i=s(a,o,e/360-1/3)}let s=e=>{let t=Math.round(255*e).toString(16);return 1===t.length?"0"+t:t};return"#".concat(s(n)).concat(s(l)).concat(s(i))}function u(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.getFullYear();if("string"==typeof e&&e.length>=4){let t=new Date(e);if(!Number.isNaN(t.getTime()))return t.getFullYear();let r=Number.parseInt(e.slice(0,4),10);return Number.isNaN(r)?null:r}return"number"==typeof e&&Number.isFinite(e)?e:null}let c=()=>window,m=()=>({nodes:[],links:[],stats:null,isRunning:!1,layoutState:{mode:"worker",reason:null,error:null}});var f=r(76795),g=r(59967),h=r(97416),x=r(18705),p=r(86710);let v=(0,l.createContext)(null);function b(e,t){switch(t.type){case"SET_MODE":return t.mode&&t.mode!==e.mode?{...e,mode:t.mode}:e;case"SET_DEPTH":return"number"==typeof t.depthFactor?{...e,depthFactor:t.depthFactor}:e;default:return e}}function y(e){let{children:t}=e,[r,i]=(0,l.useReducer)(b,{mode:"2d",depthFactor:0}),s=(0,l.useRef)(null),o=(0,l.useRef)(0),a=(0,l.useRef)(0);(0,l.useEffect)(()=>{o.current="3d"===r.mode?1:0,null!==s.current&&cancelAnimationFrame(s.current),function(e,t,r,n){let l=()=>{r.current=requestAnimationFrame(()=>{let i=t-n.current,s=.001>Math.abs(i)?t:n.current+.12*i;n.current=s,e({type:"SET_DEPTH",depthFactor:s}),Math.abs(t-s)>.001?l():r.current=null})};l()}(i,o.current,s,a);let e=s.current;return()=>{null!==e&&cancelAnimationFrame(e)}},[r.mode]);let d=(0,l.useCallback)(e=>{i({type:"SET_MODE",mode:e})},[]),u=(0,l.useCallback)(()=>{i({type:"SET_MODE",mode:"2d"===r.mode?"3d":"2d"})},[r.mode]),c=(0,l.useMemo)(()=>({mode:r.mode,depthFactor:r.depthFactor,setMode:d,toggleMode:u}),[d,r.depthFactor,r.mode,u]);return(0,n.jsx)(v.Provider,{value:c,children:t})}function N(){let e=(0,l.useContext)(v);if(!e)throw Error("useFightGraphView must be used within a FightGraphViewProvider");return e}function j(e){let{nodes:t,nodeColorMap:r,palette:i,selectedNodeId:s,hoveredNodeId:o,defaultColor:a,onHover:d,onSelect:u,depthFactor:c}=e,m=(0,l.useMemo)(()=>t.reduce((e,t)=>Math.max(e,t.degree),1),[t]);return(0,n.jsx)("group",{children:t.map(e=>{var t,l,f,g,h,x;let p=s===e.id,v=o===e.id,b=(t=null!=r?r:null,l=null!=i?i:null,(null==t?void 0:t.has(null!==(f=e.fighter_id)&&void 0!==f?f:e.id))?null!==(h=t.get(null!==(g=e.fighter_id)&&void 0!==g?g:e.id))&&void 0!==h?h:a:e.division&&(null==l?void 0:l.has(e.division))&&null!==(x=l.get(e.division))&&void 0!==x?x:a),y=.8+e.degree/Math.max(1,m)*1.8;return(0,n.jsxs)("mesh",{position:[e.x,e.y,e.z*c],onPointerOver:t=>{t.stopPropagation(),null==d||d(e.id,t)},onPointerOut:e=>{e.stopPropagation(),null==d||d(null,e)},onClick:t=>{t.stopPropagation(),null==u||u(p?null:e.id)},scale:p||v?1.4:1,children:[(0,n.jsx)("sphereGeometry",{args:[y,12,12]}),(0,n.jsx)("meshStandardMaterial",{color:b,emissive:v?b:"#000000",emissiveIntensity:v?.4:0})]},e.id)})})}function k(e){let{nodes:t,links:r,depthFactor:i}=e,s=(0,l.useMemo)(()=>{let e=new Map;for(let r of t)e.set(r.id,r);return e},[t]),o=(0,l.useMemo)(()=>r.map(e=>{let t=s.get(e.source),r=s.get(e.target);return t&&r?(0,n.jsxs)("line",{children:[(0,n.jsx)("bufferGeometry",{children:(0,n.jsx)("bufferAttribute",{attach:"attributes-position",array:new Float32Array([t.x,t.y,t.z*i,r.x,r.y,r.z*i]),itemSize:3})}),(0,n.jsx)("lineBasicMaterial",{color:"#475569",transparent:!0,opacity:.35})]},"".concat(e.source,"-").concat(e.target)):null}).filter(Boolean),[i,r,s]);return(0,n.jsx)(l.Fragment,{children:o})}function w(){let{mode:e}=N();return"3d"===e?(0,n.jsx)(g.c,{makeDefault:!0,position:[0,0,380],fov:55,near:.1,far:2e3}):(0,n.jsx)(h.i,{makeDefault:!0,position:[0,0,500],zoom:1.2,near:-1e3,far:1e3})}function _(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("ambientLight",{intensity:.65}),(0,n.jsx)("spotLight",{position:[120,260,340],angle:.45,penumbra:.5,intensity:1.2,castShadow:!0}),(0,n.jsx)("spotLight",{position:[-150,-220,-320],angle:.35,penumbra:.3,intensity:.8})]})}function M(e){let{nodes:t,links:r,nodeColorMap:l=null,palette:i=null,selectedNodeId:s,hoveredNodeId:o,defaultColor:a="#f1f5f9",onNodeHover:d,onNodeSelect:u,onPerformanceDrop:c,onPerformanceRecover:m}=e,{depthFactor:g,mode:h}=N();return(0,n.jsxs)(f.Xz,{camera:{position:[0,0,400]},dpr:[1,1.75],children:[(0,n.jsx)("color",{attach:"background",args:["#020617"]}),(0,n.jsx)(w,{}),(0,n.jsx)(_,{}),(0,n.jsx)(x.A,{onDecline:()=>null==c?void 0:c(),onIncline:()=>null==m?void 0:m(),debounce:500}),(0,n.jsx)(p.z,{enableRotate:"3d"===h,enableZoom:!0,enablePan:!0,minDistance:120,maxDistance:700}),(0,n.jsx)(k,{nodes:t,links:r,depthFactor:g}),(0,n.jsx)(j,{nodes:t,nodeColorMap:l,palette:i,selectedNodeId:s,hoveredNodeId:o,defaultColor:a,onHover:d,onSelect:u,depthFactor:g})]})}var F=r(2581);function C(e){var t,i,d,u,f;let{data:g,isLoading:h=!1,selectedNodeId:x=null,onSelectNode:p,palette:v=null,nodeColorMap:b=null,minFightsThreshold:y=2}=e,j=(0,l.useRef)(null),[k,w]=(0,l.useState)(null),{mode:_,toggleMode:C}=N(),S=(0,l.useMemo)(()=>v||(g?a(g.nodes):new Map),[g,v]),{nodes:Y,links:E,stats:I,layoutState:R,updateWorkerOptions:U}=function(e){let{workerOptions:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,l.useRef)(null),i=(0,l.useRef)(e),s=(0,l.useRef)(null),a=(0,l.useRef)(null),[d,u]=(0,l.useState)(()=>m()),f=(0,l.useCallback)(()=>{null!==s.current&&(window.clearTimeout(s.current),s.current=null)},[]),g=(0,l.useCallback)(()=>{if(null===a.current)return;let e=c();(null==e?void 0:e.cancelIdleCallback)?e.cancelIdleCallback(a.current):window.clearTimeout(a.current),a.current=null},[]),h=(0,l.useCallback)((e,t,r)=>{let n=null!=e?e:i.current;if(f(),g(),!n){u(e=>({...e,nodes:[],links:[],stats:null,isRunning:!1,layoutState:{mode:r?"error":"fallback",reason:null!=t?t:"No fight data is available yet.",error:null!=r?r:null}}));return}let l=()=>{try{let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o(e.nodes.length,t),n="undefined"!=typeof performance,l=n?performance.now():Date.now(),i=function(e,t){var r,n,l,i,s,a;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e.length)return{nodes:[],edges:[],bounds:{minX:0,maxX:0,minY:0,maxY:0}};let u=o(e.length,d),c=null!==(r=d.repulsionStrength)&&void 0!==r?r:2e3,m=null!==(n=d.linkDistance)&&void 0!==n?n:180,f=null!==(l=d.springStrength)&&void 0!==l?l:.06,g=null!==(i=d.damping)&&void 0!==i?i:.6,h=null!==(s=d.centerStrength)&&void 0!==s?s:.005,x=null!==(a=d.timeStep)&&void 0!==a?a:.4,p=e.map((t,r)=>{let n=r/Math.max(1,e.length)*Math.PI*2,l=200+1.5*e.length;return{id:t.fighter_id,source:t,x:Math.cos(n)*l,y:Math.sin(n)*l,vx:0,vy:0,ax:0,ay:0,neighbors:new Set}}),v=new Map;for(let e of p)v.set(e.id,e);let b=[];for(let e of t){let t=v.get(e.source),r=v.get(e.target);t&&r&&t.id!==r.id&&(t.neighbors.add(r.id),r.neighbors.add(t.id),b.push(e))}for(let e=0;e<u;e++){for(let e of p)e.ax=0,e.ay=0;for(let e=0;e<p.length;e++){let t=p[e];for(let r=e+1;r<p.length;r++){let e=p[r],n=e.x-t.x,l=e.y-t.y,i=n*n+l*l+.001,s=Math.sqrt(i),o=c/i;n/=s,l/=s,t.ax-=o*n,t.ay-=o*l,e.ax+=o*n,e.ay+=o*l}}for(let e of b){let t=v.get(e.source),r=v.get(e.target);if(!t||!r)continue;let n=r.x-t.x,l=r.y-t.y,i=Math.sqrt(n*n+l*l)||.001,s=f*(i-m);n/=i,l/=i,t.ax+=s*n,t.ay+=s*l,r.ax-=s*n,r.ay-=s*l}for(let e of p)e.ax-=e.x*h,e.ay-=e.y*h;for(let e of p)e.vx=(e.vx+e.ax*x)*g,e.vy=(e.vy+e.ay*x)*g,e.x+=e.vx*x,e.y+=e.vy*x}let y=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,j=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let e of p)e.x<y&&(y=e.x),e.x>N&&(N=e.x),e.y<j&&(j=e.y),e.y>k&&(k=e.y);return Number.isFinite(y)||(y=-1),Number.isFinite(N)||(N=1),Number.isFinite(j)||(j=-1),Number.isFinite(k)||(k=1),.001>Math.abs(N-y)&&(y-=1,N+=1),.001>Math.abs(k-j)&&(j-=1,k+=1),{nodes:p.map(e=>({...e.source,id:e.id,x:e.x,y:e.y,degree:e.neighbors.size,neighbors:Array.from(e.neighbors)})),edges:b.slice(),bounds:{minX:y,maxX:N,minY:j,maxY:k}}}(e.nodes,e.links,t),s=Math.max((n?performance.now():Date.now())-l,0),a=i.nodes.map(e=>({fighter_id:e.fighter_id,name:e.name,division:e.division,record:e.record,image_url:e.image_url,total_fights:e.total_fights,latest_event_date:e.latest_event_date,id:e.id,x:e.x,y:e.y,z:0,vx:0,vy:0,vz:0,degree:e.degree})),d=i.edges.map(e=>({source:e.source,target:e.target,fights:e.fights,first_event_name:e.first_event_name,first_event_date:e.first_event_date,last_event_name:e.last_event_name,last_event_date:e.last_event_date,result_breakdown:e.result_breakdown}));return{nodes:a,links:d,stats:{tickCount:r,meanTickMs:r>0?s/r:s,lastTickMs:s,alpha:0}}}(n);u({nodes:e.nodes,links:e.links,stats:e.stats,isRunning:!1,layoutState:{mode:"fallback",reason:null!=t?t:"Fight graph worker is unavailable. Showing a simplified layout.",error:null!=r?r:null}})}catch(e){u({nodes:[],links:[],stats:null,isRunning:!1,layoutState:{mode:"error",reason:null!=t?t:"Fight graph worker and fallback layout both failed to initialize.",error:e instanceof Error?e:Error("Failed to compute fallback fight layout")}})}},s=c();if(null==s?void 0:s.requestIdleCallback){a.current=s.requestIdleCallback(()=>{a.current=null,l()},{timeout:300});return}{let e=window.setTimeout(()=>{a.current=null,l()},0);a.current=e;return}},[g,f]),x=(0,l.useCallback)(e=>{f(),s.current=window.setTimeout(()=>{s.current=null,h(e,"Timed out waiting for the fight graph worker. Falling back to a simplified layout.")},2e3)},[f,h]);(0,l.useEffect)(()=>()=>{f(),g()},[g,f]),(0,l.useEffect)(()=>{i.current=e},[e]),(0,l.useEffect)(()=>{n.current=function(){try{return new Worker(r.tu(new URL(r.p+r.u(5205),r.b)),{type:void 0})}catch(e){return console.warn("Failed to create fight layout worker",e),null}}();let e=n.current;if(!e)return i.current&&h(i.current,"Fight graph worker is unavailable in this environment."),()=>void 0;let t=e=>{f(),u({nodes:e.data.nodes,links:e.data.links,stats:e.data.stats,isRunning:"TICK"===e.data.type&&e.data.stats.alpha>.01,layoutState:{mode:"worker",reason:null,error:null}})},l=e=>{var t;h(i.current,"Fight graph worker crashed. Rendering a simplified layout instead.",e.error instanceof Error?e.error:Error(null!==(t=e.message)&&void 0!==t?t:"Worker error"))};return e.addEventListener("message",t),e.addEventListener("error",l),()=>{e.removeEventListener("message",t),e.removeEventListener("error",l);try{e.postMessage({type:"TERMINATE"})}catch(e){}e.terminate(),n.current=null}},[f,h]);let p=(0,l.useCallback)((e,r)=>{if(i.current=e,!e){u(m());return}let l=n.current;if(!l){h(e,"Fight graph worker could not be initialized. Showing a simplified layout.");return}let s={type:"INIT",nodes:e.nodes,links:e.links,options:{...t,...null!=r?r:{}}};try{l.postMessage(s),u(e=>({...e,isRunning:!0,layoutState:{mode:"worker",reason:null,error:null}})),x(e)}catch(t){h(e,"Failed to communicate with the fight graph worker.",t instanceof Error?t:Error("Failed to post message to worker"))}},[h,x,t]),v=(0,l.useCallback)(e=>{let t=n.current;t&&t.postMessage({type:"UPDATE_OPTIONS",options:e})},[]);return(0,l.useEffect)(()=>{if(!e){g(),f(),u(m());return}p(e)},[g,f,e,p]),(0,l.useMemo)(()=>({nodes:d.nodes,links:d.links,stats:d.stats,isRunning:d.isRunning,layoutState:d.layoutState,refresh:p,updateWorkerOptions:v}),[p,d.links,d.nodes,d.stats,d.isRunning,d.layoutState,v])}(g,{workerOptions:(0,l.useMemo)(()=>({linkDistance:200,chargeStrength:-45,updateIntervalMs:26,zScale:.85}),[])}),T=null!==(t=null==g?void 0:g.nodes.length)&&void 0!==t?t:0,A=!h&&null!==g&&0===T,D="fallback"===R.mode||"error"===R.mode,L=null!==(i=R.reason)&&void 0!==i?i:"error"===R.mode?"Unable to render the fight graph layout on this device.":"Using a simplified fight graph layout.",B=null!==(u=null!==(d=null==k?void 0:k.nodeId)&&void 0!==d?d:x)&&void 0!==u?u:null,P=(0,l.useMemo)(()=>E.filter(e=>!!B&&(e.source===B||e.target===B)||e.fights>=y),[B,E,y]),O=(0,l.useMemo)(()=>{var e;return k&&null!==(e=Y.find(e=>e.id===k.nodeId))&&void 0!==e?e:null},[k,Y]),z=(0,l.useCallback)((e,t)=>{if(!e||!t){w(null);return}let r=Y.find(t=>t.id===e);if(!r){w(null);return}w({nodeId:r.id,clientX:t.clientX,clientY:t.clientY})},[Y]),Z=(0,l.useCallback)(e=>{null==p||p(e)},[p]),W=(0,l.useCallback)(()=>{U({updateIntervalMs:42,chargeStrength:-32})},[U]),q=(0,l.useCallback)(()=>{U({updateIntervalMs:26,chargeStrength:-45})},[U]),H=(0,l.useMemo)(()=>{if(!k||!j.current)return null;let e=j.current.getBoundingClientRect();return{left:k.clientX-e.left+12,top:k.clientY-e.top+12}},[k]);return(0,n.jsxs)("div",{className:"relative flex h-[520px] w-full flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-4 pt-2",children:[(0,n.jsx)(F.z,{variant:"secondary",size:"sm",onClick:C,children:"3d"===_?"Switch to 2D":"Switch to 3D"}),I?(0,n.jsxs)("div",{className:"text-xs text-slate-400",children:["tick ",I.tickCount.toFixed(0)," \xb7 avg"," ",I.meanTickMs.toFixed(2)," ms"]}):null]}),(0,n.jsxs)("div",{ref:j,className:"relative h-full w-full overflow-hidden rounded-lg border border-slate-800 bg-slate-950/70",children:[D?(0,n.jsx)("div",{className:"pointer-events-none absolute left-4 top-4 z-30 max-w-sm rounded-md border border-amber-400/60 bg-slate-950/90 px-3 py-2 text-xs text-amber-100 shadow-lg",children:L}):null,A?(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center text-sm text-slate-400",children:"We could not find enough data to construct the fight network."}):(0,n.jsxs)(n.Fragment,{children:[h?(0,n.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-slate-950/80 text-sm text-slate-300",children:"Computing layout…"}):null,(0,n.jsx)(M,{nodes:Y,links:P,nodeColorMap:null!=b?b:null,palette:S,selectedNodeId:null!=x?x:null,hoveredNodeId:null!==(f=null==k?void 0:k.nodeId)&&void 0!==f?f:null,defaultColor:s,onNodeHover:z,onNodeSelect:Z,onPerformanceDrop:W,onPerformanceRecover:q}),O&&H?(0,n.jsxs)("div",{className:"pointer-events-none absolute z-30 rounded-lg border border-slate-800 bg-slate-900/90 px-3 py-2 text-xs text-slate-100 shadow-lg",style:{left:H.left,top:H.top},children:[(0,n.jsx)("div",{className:"font-semibold",children:O.name}),O.record?(0,n.jsx)("div",{className:"text-slate-300",children:O.record}):null,(0,n.jsxs)("div",{className:"text-slate-400",children:["Total fights: ",O.total_fights]})]}):null]})]})]})}function S(e){return(0,n.jsx)(y,{children:(0,n.jsx)(C,{...e})})}var Y=r(18986),E=r(79185),I=r(15162),R=r(7312);let U="most_active",T={most_active:{label:"Most Active",description:"Highest total fights first"},alphabetical:{label:"Alphabetical",description:"Order by fighter name A-Z"},most_recent:{label:"Most Recent",description:"Newest/latest fight dates first"}};function A(e){return"string"==typeof e&&e in T}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return"number"!=typeof e||Number.isNaN(e)?t:Math.min(400,Math.max(25,Math.round(e)))}function L(e){return"number"!=typeof e||Number.isNaN(e)?null:e}function B(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,n=D(e.limit,r),l=L(e.startYear),i=L(e.endYear);null!==l&&null!==i&&l>i&&([l,i]=[i,l]);let s=O(e.sortBy);return{division:null!==(t=e.division)&&void 0!==t?t:null,startYear:l,endYear:i,limit:n,includeUpcoming:!!e.includeUpcoming,sortBy:s}}function P(e,t){var r,n,l,i,s,o,a,d;return(null!==(r=e.division)&&void 0!==r?r:null)===(null!==(n=t.division)&&void 0!==n?n:null)&&(null!==(l=e.startYear)&&void 0!==l?l:null)===(null!==(i=t.startYear)&&void 0!==i?i:null)&&(null!==(s=e.endYear)&&void 0!==s?s:null)===(null!==(o=t.endYear)&&void 0!==o?o:null)&&D(null!==(a=e.limit)&&void 0!==a?a:null)===D(null!==(d=t.limit)&&void 0!==d?d:null)&&!!e.includeUpcoming==!!t.includeUpcoming&&O(e.sortBy)===O(t.sortBy)}function O(e){return e&&A(e)?e:U}function z(e){var t,r,i,s;let{filters:o,onApply:a,onReset:d,availableDivisions:u,yearBounds:c,isLoading:m=!1,isRefreshing:f=!1,error:g=null,onRetry:h}=e,[x,p]=(0,l.useState)(B(o)),v=(0,l.useRef)(!0);(0,l.useEffect)(()=>{p(B(o)),v.current=!0},[o]),(0,l.useEffect)(()=>{if(v.current){v.current=!1;return}let e=B(x);if(P(e,o))return;let t=setTimeout(()=>{a(e)},400);return()=>{clearTimeout(t)}},[x,o,a]);let b=(0,l.useMemo)(()=>[...u].sort((e,t)=>e.localeCompare(t)),[u]),y=(0,l.useMemo)(()=>c?{min:c.min,max:c.max}:null,[c]);return(0,n.jsxs)("aside",{className:"space-y-4 rounded-3xl border border-border/80 bg-card/60 p-6",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[f&&(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-dashed border-border/80 bg-muted/30 px-3 py-2 text-xs font-medium text-muted-foreground",role:"status","aria-live":"polite","aria-label":"Refreshing fight graph",children:[(0,n.jsx)(R.Z,{className:"h-3.5 w-3.5 animate-spin"}),(0,n.jsx)("span",{children:"Refreshing graph data…"})]}),g&&(0,n.jsxs)("div",{className:"space-y-2 rounded-2xl border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:[(0,n.jsx)("p",{className:"font-medium",children:g}),h&&(0,n.jsx)("button",{type:"button",onClick:()=>{h()},className:"inline-flex items-center justify-center rounded-full border border-destructive/50 px-3 py-1 text-xs font-semibold text-destructive transition hover:border-destructive hover:bg-destructive/10",children:"Retry request"})]})]}),(0,n.jsxs)("header",{className:"space-y-2",children:[(0,n.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Filters"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Refine the network by narrowing the weight class, year range, or node count. Filters apply automatically as you adjust them."})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(B(x))},className:"space-y-4",children:[(0,n.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:"Division"}),(0,n.jsxs)("select",{value:null!==(t=x.division)&&void 0!==t?t:"ALL",onChange:e=>{let t=e.target.value;p(e=>({...e,division:"ALL"===t?null:t}))},className:"w-full rounded-2xl border border-border bg-background px-3 py-2 text-sm text-foreground shadow-sm outline-none transition focus:border-foreground focus:ring-2 focus:ring-foreground/20",children:[(0,n.jsx)("option",{value:"ALL",children:"All divisions"}),b.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,n.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:"Start year"}),(0,n.jsx)("input",{type:"number",inputMode:"numeric",value:null!==(r=x.startYear)&&void 0!==r?r:"",placeholder:y?String(y.min):"Any",onChange:e=>{let t=e.target.value;p(e=>({...e,startYear:""===t?null:Number(t)}))},className:"w-full rounded-2xl border border-border bg-background px-3 py-2 text-sm text-foreground shadow-sm outline-none transition focus:border-foreground focus:ring-2 focus:ring-foreground/20"})]}),(0,n.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:"End year"}),(0,n.jsx)("input",{type:"number",inputMode:"numeric",value:null!==(i=x.endYear)&&void 0!==i?i:"",placeholder:y?String(y.max):"Any",onChange:e=>{let t=e.target.value;p(e=>({...e,endYear:""===t?null:Number(t)}))},className:"w-full rounded-2xl border border-border bg-background px-3 py-2 text-sm text-foreground shadow-sm outline-none transition focus:border-foreground focus:ring-2 focus:ring-foreground/20"})]})]}),(0,n.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:"Node limit"}),(0,n.jsx)("input",{type:"number",min:25,max:400,step:5,value:null!==(s=x.limit)&&void 0!==s?s:"",onChange:e=>{let t=Number(e.target.value);p(e=>({...e,limit:Number.isNaN(t)?e.limit:D(t)}))},className:"w-full rounded-2xl border border-border bg-background px-3 py-2 text-sm text-foreground shadow-sm outline-none transition focus:border-foreground focus:ring-2 focus:ring-foreground/20"}),(0,n.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Between ",25," and ",400," fighters."]})]}),(0,n.jsxs)("label",{className:"flex items-center justify-between rounded-2xl border border-border bg-background/80 px-4 py-3 text-sm text-foreground shadow-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:"Include upcoming bouts"}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toggle to include fights marked as “Next”."})]}),(0,n.jsx)("input",{type:"checkbox",checked:!!x.includeUpcoming,onChange:e=>p(t=>({...t,includeUpcoming:e.target.checked})),className:"h-4 w-4 rounded border border-border text-foreground focus:ring-foreground/20"})]}),(0,n.jsx)("div",{className:"flex flex-col gap-2 pt-2 sm:flex-row sm:items-center sm:justify-end",children:(0,n.jsx)("button",{type:"button",onClick:()=>{d()},disabled:m,className:"inline-flex items-center justify-center rounded-full border border-border px-4 py-2 text-sm text-muted-foreground transition hover:border-foreground hover:text-foreground disabled:cursor-not-allowed disabled:opacity-60",children:"Reset to defaults"})})]})]})}var Z=r(63917),W=r(522),q=r(90475),H=r(78235);let V={most_active:Z.Z,alphabetical:W.Z,most_recent:q.Z};function G(e){let{sortBy:t=U,onChange:r,disabled:l=!1}=e;return(0,n.jsxs)("aside",{className:"space-y-4 rounded-3xl border border-border/80 bg-card/60 p-6",children:[(0,n.jsxs)("header",{className:"space-y-2",children:[(0,n.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Sort fighters"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Change the ordering applied to the loaded graph nodes."})]}),(0,n.jsx)("div",{className:"space-y-2",children:Object.entries(T).map(e=>{let[i,s]=e,o=V[i],a=t===i;return(0,n.jsxs)("button",{type:"button",disabled:l,onClick:()=>{l||a||r(i)},className:(0,H.cn)("flex w-full items-start gap-3 rounded-2xl border px-4 py-3 text-left transition","bg-background/60 border-border/70 hover:border-foreground/70",a&&"border-foreground bg-foreground/5 ring-2 ring-foreground/10",l&&"cursor-not-allowed opacity-60 hover:border-border/70"),"aria-pressed":a,children:[(0,n.jsx)(o,{className:"mt-0.5 h-4 w-4 text-muted-foreground"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"font-medium text-foreground/90",children:s.label}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:s.description})]}),a?(0,n.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-foreground",children:"Active"}):null]},i)})})]})}var X=r(52711);function K(e){let{insights:t,onSelectFighter:r}=e;return(0,n.jsxs)(X.Zb,{className:"border border-border/80 bg-card/60",children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{className:"text-sm font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Network insights"})}),(0,n.jsxs)(X.aY,{className:"space-y-6 text-sm text-muted-foreground",children:[(0,n.jsxs)("section",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/70",children:"Top fight hubs"}),0===t.topFighters.length?(0,n.jsx)("p",{children:"No fighters available for this filter set."}):(0,n.jsx)("ul",{className:"space-y-1",children:t.topFighters.map(e=>{var t;return(0,n.jsx)("li",{children:(0,n.jsxs)("button",{type:"button",onClick:()=>null==r?void 0:r(e.fighterId),className:"flex w-full items-center justify-between rounded-2xl border border-border/70 bg-background/60 px-3 py-2 text-left text-foreground transition hover:border-foreground hover:bg-background",children:[(0,n.jsxs)("span",{className:"font-medium text-foreground/90",children:[e.name,(0,n.jsx)("span",{className:"ml-2 text-xs uppercase tracking-[0.3em] text-muted-foreground/70",children:null!==(t=e.division)&&void 0!==t?t:"Unlisted"})]}),(0,n.jsxs)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:[e.totalFights," fights"]})]})},e.fighterId)})})]}),(0,n.jsxs)("section",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/70",children:"High-volume rivalries"}),0===t.busiestRivalries.length?(0,n.jsx)("p",{children:"No rivalry data available for this view."}):(0,n.jsx)("ul",{className:"space-y-1",children:t.busiestRivalries.map(e=>{var t,r;return(0,n.jsxs)("li",{className:"rounded-2xl border border-border/70 bg-background/40 px-3 py-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-foreground",children:[(0,n.jsxs)("span",{className:"font-medium text-foreground/90",children:[null!==(t=e.sourceName)&&void 0!==t?t:e.source,(0,n.jsx)("span",{className:"mx-2 text-xs uppercase tracking-[0.3em] text-muted-foreground/60",children:"vs"}),null!==(r=e.targetName)&&void 0!==r?r:e.target]}),(0,n.jsxs)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:[e.fights," fights"]})]}),e.lastEventName?(0,n.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground/80",children:["Last met at ",e.lastEventName]}):null]},"".concat(e.source,"-").concat(e.target))})})]})]})]})}function Q(e){let{palette:t,breakdown:r}=e;if(0===t.size)return null;let l=Array.from(t.entries()).sort((e,t)=>{var n,l,i,s;let o=null!==(i=null===(n=r.find(t=>t.division===e[0]))||void 0===n?void 0:n.count)&&void 0!==i?i:0;return(null!==(s=null===(l=r.find(e=>e.division===t[0]))||void 0===l?void 0:l.count)&&void 0!==s?s:0)-o}),i=new Map(r.map(e=>[e.division,e]));return(0,n.jsxs)(X.Zb,{className:"border border-border/80 bg-card/60",children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{className:"text-sm font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Division legend"})}),(0,n.jsx)(X.aY,{className:"space-y-3 text-sm text-muted-foreground",children:l.map(e=>{let[t,r]=e,l=i.get(t),s=l?"".concat(l.count," fighters • ").concat(l.percentage,"%"):"No fighters in current slice";return(0,n.jsxs)("div",{className:"flex items-center justify-between rounded-2xl border border-border/70 bg-background/60 px-3 py-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{"aria-hidden":!0,className:"inline-flex h-3.5 w-3.5 rounded-full",style:{backgroundColor:r}}),(0,n.jsx)("span",{className:"font-medium text-foreground/90",children:t})]}),(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/70",children:s})]},t)})})]})}function $(e){let{nodes:t,onSelect:r,onClear:i}=e,[s,o]=(0,l.useState)(""),a=(0,l.useId)(),d=(0,l.useMemo)(()=>t.map(e=>({id:e.fighter_id,name:e.name})),[t]);return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=s.trim();if(0===t.length)return;let n=d.find(e=>e.name.toLowerCase()===t.toLowerCase());if(n){r(n.id);return}let l=d.find(e=>e.name.toLowerCase().includes(t.toLowerCase()));l&&r(l.id)},className:"flex flex-col gap-2 rounded-3xl border border-border/80 bg-card/60 p-4",children:[(0,n.jsxs)("label",{className:"flex flex-col gap-2 text-sm text-muted-foreground",children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/90",children:"Focus a fighter"}),(0,n.jsx)("input",{list:a,value:s,onChange:e=>{let t=e.target.value;o(t);let n=d.find(e=>e.name.toLowerCase()===t.toLowerCase());n&&r(n.id)},placeholder:"Search within the loaded fighters",className:"w-full rounded-2xl border border-border bg-background px-3 py-2 text-sm text-foreground shadow-sm outline-none transition focus:border-foreground focus:ring-2 focus:ring-foreground/20"}),(0,n.jsx)("datalist",{id:a,children:d.slice(0,50).map(e=>(0,n.jsx)("option",{value:e.name},e.id))})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,n.jsx)("button",{type:"submit",className:"inline-flex items-center justify-center rounded-full bg-foreground px-3 py-1 font-semibold text-background transition hover:bg-foreground/90",children:"Focus"}),(0,n.jsx)("button",{type:"button",onClick:()=>{o(""),null==i||i()},className:"inline-flex items-center justify-center rounded-full border border-border px-3 py-1 font-semibold text-muted-foreground transition hover:border-foreground hover:text-foreground",children:"Clear"}),(0,n.jsxs)("span",{className:"ml-auto",children:[d.length," fighters loaded"]})]})]})}function J(e){var t,r;let{selectedNode:l,connections:i}=e;return l?(0,n.jsxs)(X.Zb,{className:"border border-border/80 bg-card",children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:l.name})}),(0,n.jsxs)(X.aY,{className:"space-y-3 text-sm text-muted-foreground",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"uppercase tracking-[0.3em] text-muted-foreground/80",children:"Record"}),(0,n.jsx)("span",{children:null!==(t=l.record)&&void 0!==t?t:"Unknown"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"uppercase tracking-[0.3em] text-muted-foreground/80",children:"Division"}),(0,n.jsx)("span",{children:null!==(r=l.division)&&void 0!==r?r:"Unlisted"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"uppercase tracking-[0.3em] text-muted-foreground/80",children:"Total fights"}),(0,n.jsx)("span",{children:l.total_fights.toLocaleString("en-US")})]}),i.length>0?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/80",children:"Key connections"}),(0,n.jsx)("ul",{className:"space-y-2 text-sm",children:i.map(e=>{let{fighter:t,link:r}=e;return(0,n.jsxs)("li",{className:"flex items-center justify-between rounded-2xl border border-border/70 bg-background/50 px-3 py-2",children:[(0,n.jsx)("span",{className:"text-foreground/90",children:t.name}),(0,n.jsxs)("span",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground",children:[r.fights," fights"]})]},"".concat(l.fighter_id,"-").concat(t.fighter_id))})})]}):(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Select a connected fighter in the graph to explore rivalries."})]})]}):(0,n.jsxs)(X.Zb,{className:"border border-dashed border-border/60 bg-card/40",children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:"Inspect fighters"})}),(0,n.jsx)(X.aY,{className:"text-sm text-muted-foreground",children:"Click a node in the graph or search for a fighter to reveal their key connections."})]})}function ee(e){return e.toLocaleString("en-US")}function et(e){var t;let{nodeCount:r,linkCount:l,filters:i,fallbackLimit:s,insights:o}=e,a=i.division&&i.division.trim().length>0?i.division:"All divisions";return(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,n.jsxs)(X.Zb,{children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:"Indexed Fighters"})}),(0,n.jsxs)(X.aY,{className:"pt-0",children:[(0,n.jsx)("div",{className:"text-3xl font-semibold tracking-tight",children:ee(r)}),(0,n.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"Fighters represented in the current network slice."})]})]}),(0,n.jsxs)(X.Zb,{children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:"Fight Connections"})}),(0,n.jsxs)(X.aY,{className:"pt-0",children:[(0,n.jsx)("div",{className:"text-3xl font-semibold tracking-tight",children:ee(l)}),(0,n.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"Unique rivalries connecting the selected fighters."})]})]}),(0,n.jsxs)(X.Zb,{children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:"Network Density"})}),(0,n.jsxs)(X.aY,{className:"pt-0",children:[(0,n.jsx)("div",{className:"text-3xl font-semibold tracking-tight",children:o.networkDensity.toFixed(3)}),(0,n.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"Normalized connectivity score showing how tightly packed the graph is."})]})]}),(0,n.jsxs)(X.Zb,{children:[(0,n.jsx)(X.Ol,{children:(0,n.jsx)(X.ll,{children:"Scope"})}),(0,n.jsxs)(X.aY,{className:"space-y-2 pt-0 text-sm text-muted-foreground",children:[(0,n.jsx)("div",{className:"font-medium text-foreground",children:a}),(0,n.jsx)("div",{children:function(e){var t,r;let n=null!==(t=e.startYear)&&void 0!==t?t:null,l=null!==(r=e.endYear)&&void 0!==r?r:null;return n&&l?"".concat(n," – ").concat(l):n?"".concat(n," onward"):l?"≤ ".concat(l):"All recorded years"}(i)}),(0,n.jsxs)("div",{className:"text-xs uppercase tracking-[0.3em] text-muted-foreground/80",children:["Limit ",ee(null!==(t=i.limit)&&void 0!==t?t:s)," • ",i.includeUpcoming?"Upcoming included":"Upcoming excluded"]})]})]})]})}function er(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}let en={division:"division",startYear:"startYear",endYear:"endYear",limit:"limit",includeUpcoming:"upcoming",sortBy:"sortBy"};function el(e){var t,r,i;let{initialData:o,initialFilters:c,initialError:m}=e,f=(0,Y.useRouter)(),g=(0,Y.usePathname)(),h=(0,Y.useSearchParams)(),x=(0,l.useMemo)(()=>{var e,t;return D(null!==(t=null!==(e=null==c?void 0:c.limit)&&void 0!==e?e:null==o?void 0:o.nodes.length)&&void 0!==t?t:150)},[null==o?void 0:o.nodes.length,null==c?void 0:c.limit]),p=(0,l.useMemo)(()=>{var e,t,r,n,l;return B({division:null!==(e=null==c?void 0:c.division)&&void 0!==e?e:null,startYear:null!==(t=null==c?void 0:c.startYear)&&void 0!==t?t:null,endYear:null!==(r=null==c?void 0:c.endYear)&&void 0!==r?r:null,limit:x,includeUpcoming:null!==(n=null==c?void 0:c.includeUpcoming)&&void 0!==n&&n,sortBy:null!==(l=null==c?void 0:c.sortBy)&&void 0!==l?l:U},x)},[x,null==c?void 0:c.division,null==c?void 0:c.endYear,null==c?void 0:c.includeUpcoming,null==c?void 0:c.startYear,null==c?void 0:c.sortBy]),v=h.toString(),b=(0,l.useMemo)(()=>(function(e,t){var r,n,l,i,s,o,a;let d=new URLSearchParams(e),u={division:null!==(r=t.division)&&void 0!==r?r:null,startYear:null!==(n=t.startYear)&&void 0!==n?n:null,endYear:null!==(l=t.endYear)&&void 0!==l?l:null,limit:null!==(i=t.limit)&&void 0!==i?i:null,includeUpcoming:null!==(s=t.includeUpcoming)&&void 0!==s&&s,sortBy:null!==(o=t.sortBy)&&void 0!==o?o:U},c=d.get(en.division);null!==c&&(u.division=c.trim().length>0?c:null);let m=e=>{if(null===e)return null;let t=Number.parseInt(e,10);return Number.isFinite(t)?t:null};if(d.has(en.startYear)&&(u.startYear=m(d.get(en.startYear))),d.has(en.endYear)&&(u.endYear=m(d.get(en.endYear))),d.has(en.limit)&&(u.limit=m(d.get(en.limit))),d.has(en.includeUpcoming)){let e=d.get(en.includeUpcoming);if(e){let t=e.toLowerCase();"1"===t||"true"===t||"yes"===t?u.includeUpcoming=!0:("0"===t||"false"===t||"no"===t)&&(u.includeUpcoming=!1)}else u.includeUpcoming=null!==(a=t.includeUpcoming)&&void 0!==a&&a}let f=d.get(en.sortBy);return f&&A(f)&&(u.sortBy=f),u})(v,p),[v,p]),y=(0,l.useMemo)(()=>B(b,x),[b,x]),N=(0,l.useMemo)(()=>o&&P(y,p)?o:null,[y,p,o]),{data:j,status:k,error:w,refetch:_,isFetching:M}=(0,I.P)(y,{initialData:N}),F=null!=j?j:null,C="pending"===k&&!F,R=M&&!C,[T,L]=(0,l.useState)(null),O=(0,l.useRef)(y);(0,l.useEffect)(()=>{P({...O.current,sortBy:U},{...y,sortBy:U})||L(null),O.current=y},[y]);let[Z,W]=(0,l.useState)(null!=m?m:null),q=(0,l.useRef)(null!=m?m:null),H=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(q.current){let e=q.current;E.Am.error(e,{duration:6e3,action:{label:"Retry",onClick:()=>{_()}}}),H.current=e,q.current=null}},[_]),(0,l.useEffect)(()=>{if(w){var e,t;let r=null!==(t=null!==(e=w.detail)&&void 0!==e?e:w.message)&&void 0!==t?t:"Unable to refresh the FightWeb graph.";W(r),H.current!==r&&(E.Am.error(r,{duration:6e3,action:{label:"Retry",onClick:()=>{_()}}}),H.current=r);return}"success"===k&&(W(null),H.current=null)},[w,_,k]);let V=(0,l.useCallback)(e=>{var t,r;let n=B(e,null!==(r=null!==(t=e.limit)&&void 0!==t?t:p.limit)&&void 0!==r?r:x);if(P(n,y))return;if(P(n,p)){f.replace(g,{scroll:!1});return}let l=(function(e){var t;let r=new URLSearchParams;e.division&&e.division.trim().length>0&&r.set(en.division,e.division.trim()),"number"==typeof e.startYear&&r.set(en.startYear,String(e.startYear)),"number"==typeof e.endYear&&r.set(en.endYear,String(e.endYear)),"number"==typeof e.limit&&r.set(en.limit,String(e.limit)),e.includeUpcoming&&r.set(en.includeUpcoming,"true");let n=null!==(t=e.sortBy)&&void 0!==t?t:U;return n!==U&&r.set(en.sortBy,n),r})(n).toString();f.replace(l.length>0?"".concat(g,"?").concat(l):g,{scroll:!1})},[y,p,x,g,f]),X=(0,l.useCallback)(()=>{if(P(y,p)){L(null);return}V(p)},[y,V,p]),ee=(0,l.useCallback)(e=>{V({...y,sortBy:e})},[y,V]),el=null!==(t=null==F?void 0:F.nodes.length)&&void 0!==t?t:0,ei=null!==(r=null==F?void 0:F.links.length)&&void 0!==r?r:0,es=(0,l.useMemo)(()=>(function(e){if(!e)return[];let t=new Set;for(let r of e.nodes)r.division&&r.division.trim().length>0&&t.add(r.division.trim());return Array.from(t)})(F),[F]),eo=(0,l.useMemo)(()=>(function(e){var t;if(!e)return null;let r=(null!==(t=e.metadata)&&void 0!==t?t:{}).event_window;if(r&&"object"==typeof r&&!Array.isArray(r)){let e=u(r.start),t=u(r.end);if(null!==e&&null!==t)return{min:e,max:t}}let n=null,l=null;for(let t of e.links){let e=u(t.first_event_date),r=u(t.last_event_date);null!==e&&(n=null===n?e:Math.min(n,e)),null!==r&&(l=null===l?r:Math.max(l,r))}return null!==n&&null!==l?{min:n,max:l}:null})(F),[F]),ea=(0,l.useMemo)(()=>F?a(F.nodes):new Map,[F]),ed=(0,l.useMemo)(()=>{if(!y.division||!F)return!1;let e=y.division.trim();if(0===e.length)return!1;let t=F.nodes.filter(e=>e.division&&e.division.trim().length>0);return 0!==t.length&&t.every(t=>{var r;return(null===(r=t.division)||void 0===r?void 0:r.trim())===e})},[y.division,F]),eu=(0,l.useMemo)(()=>{var e;if(!ed||!F||!y.division)return null;let t=null!==(e=ea.get(y.division.trim()))&&void 0!==e?e:s;return function(e,t){let r=new Map;if(0===e.length)return r;let n=[];for(let t of e)if(t.latest_event_date)try{let e=new Date(t.latest_event_date);Number.isNaN(e.getTime())||n.push({id:t.fighter_id,timestamp:e.getTime()})}catch(e){}if(0===n.length){for(let n of e)r.set(n.fighter_id,t);return r}let l=n.map(e=>e.timestamp),i=Math.min(...l),s=Math.max(...l)-i,o=function(e){let t=e.replace("#",""),r=Number.parseInt(t.substring(0,2),16)/255,n=Number.parseInt(t.substring(2,4),16)/255,l=Number.parseInt(t.substring(4,6),16)/255,i=Math.max(r,n,l),s=Math.min(r,n,l),o=0,a=0,d=(i+s)/2;if(i!==s){let e=i-s;switch(a=d>.5?e/(2-i-s):e/(i+s),i){case r:o=((n-l)/e+(n<l?6:0))/6;break;case n:o=((l-r)/e+2)/6;break;case l:o=((r-n)/e+4)/6}}return{h:360*o,s:a,l:d}}(t);if(!o){for(let n of e)r.set(n.fighter_id,t);return r}for(let t of e){let e=n.find(e=>e.id===t.fighter_id);if(!e){r.set(t.fighter_id,d(o.h,.3*o.s,.4*o.l));continue}let l=Math.pow(s>0?(e.timestamp-i)/s:1,.7),a=.3+.7*l,u=.35+.3*l,c=d(o.h,a,u);r.set(t.fighter_id,c)}for(let t of e)r.has(t.fighter_id)||r.set(t.fighter_id,d(o.h,.3*o.s,.4*o.l));return r}(F.nodes,t)},[ed,F,y.division,ea]),ec=(0,l.useMemo)(()=>{var e;if(!F)return[];let t=null!==(e=y.sortBy)&&void 0!==e?e:U;return function(e,t){let r=[...e];switch(t){case"alphabetical":return r.sort((e,t)=>e.name.localeCompare(t.name));case"most_recent":return r.sort((e,t)=>{let r=e.latest_event_date,n=t.latest_event_date;if(r&&n){let e=n.localeCompare(r);if(0!==e)return e}else if(!r&&n)return 1;else if(r&&!n)return -1;return e.name.localeCompare(t.name)});default:return r.sort((e,t)=>t.total_fights!==e.total_fights?t.total_fights-e.total_fights:e.name.localeCompare(t.name))}}(F.nodes,t)},[y.sortBy,F]),em=(0,l.useMemo)(()=>(function(e,t){var r,n;if(!e)return{averageFightsPerFighter:0,networkDensity:0,divisionBreakdown:[],topFighters:[],busiestRivalries:[]};let l=er(e.metadata)?e.metadata:{},i=er(l.insights)?l.insights:null;if(i){let e=Number(null!==(r=i.network_density)&&void 0!==r?r:0)||0,t=Number(null!==(n=i.average_fights_per_fighter)&&void 0!==n?n:0)||0,l=Array.isArray(i.division_breakdown)?i.division_breakdown:[],s=Array.isArray(i.top_fighters)?i.top_fighters:[],o=Array.isArray(i.busiest_rivalries)?i.busiest_rivalries:[],a=l.map(e=>({division:"string"==typeof e.division&&e.division.length>0?e.division:"Unknown",count:"number"==typeof e.count?e.count:0,percentage:"number"==typeof e.percentage?Number(e.percentage.toFixed(1)):0})).filter(e=>e.count>0).sort((e,t)=>t.count-e.count),d=s.map(e=>({fighterId:"string"==typeof e.fighter_id?e.fighter_id:"",name:"string"==typeof e.name?e.name:"Unknown",division:"string"==typeof e.division?e.division:null,totalFights:"number"==typeof e.total_fights?e.total_fights:0,degree:"number"==typeof e.degree?e.degree:0})).filter(e=>e.fighterId.length>0).sort((e,t)=>t.totalFights===e.totalFights?t.degree-e.degree:t.totalFights-e.totalFights).slice(0,5),u=o.map(e=>({source:"string"==typeof e.source?e.source:"",target:"string"==typeof e.target?e.target:"",sourceName:"string"==typeof e.source_name?e.source_name:null,targetName:"string"==typeof e.target_name?e.target_name:null,fights:"number"==typeof e.fights?e.fights:0,lastEventName:(e.last_event_name,e.last_event_name),lastEventDate:"string"==typeof e.last_event_date?e.last_event_date:null})).filter(e=>e.source.length>0&&e.target.length>0).sort((e,t)=>t.fights-e.fights).slice(0,5);return{averageFightsPerFighter:Number(t.toFixed(2)),networkDensity:Number(e.toFixed(4)),divisionBreakdown:a,topFighters:d,busiestRivalries:u}}let s=t&&t.length>0?t:e.nodes,o=new Map(s.map(e=>[e.fighter_id,e])),a=function(e){let t=new Map;for(let l of e){var r,n;t.set(l.source,(null!==(r=t.get(l.source))&&void 0!==r?r:0)+1),t.set(l.target,(null!==(n=t.get(l.target))&&void 0!==n?n:0)+1)}return t}(e.links);return{averageFightsPerFighter:Number((s.reduce((e,t)=>e+t.total_fights,0)/Math.max(1,s.length)).toFixed(2)),networkDensity:function(e,t){if(e<=1)return 0;let r=e*(e-1)/2;return r<=0?0:Number(Math.min(1,Math.max(0,t/r)).toFixed(4))}(s.length,e.links.length),divisionBreakdown:function(e){if(0===e.length)return[];let t=new Map;for(let l of e){var r,n;let e=(null!==(r=l.division)&&void 0!==r?r:"Unknown").trim()||"Unknown";t.set(e,(null!==(n=t.get(e))&&void 0!==n?n:0)+1)}let l=Array.from(t.values()).reduce((e,t)=>e+t,0)||1;return Array.from(t.entries()).map(e=>{let[t,r]=e;return{division:t,count:r,percentage:Number((r/l*100).toFixed(1))}}).sort((e,t)=>t.count-e.count)}(s),topFighters:[...s].map(e=>{var t;return{fighterId:e.fighter_id,name:e.name,division:e.division,totalFights:e.total_fights,degree:null!==(t=a.get(e.fighter_id))&&void 0!==t?t:0}}).sort((e,t)=>t.totalFights===e.totalFights?t.degree-e.degree:t.totalFights-e.totalFights).slice(0,5),busiestRivalries:[...e.links].sort((e,t)=>t.fights-e.fights).slice(0,5).map(e=>{var t,r,n,l;let i=o.get(e.source),s=o.get(e.target);return{source:e.source,target:e.target,sourceName:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:null,targetName:null!==(r=null==s?void 0:s.name)&&void 0!==r?r:null,fights:e.fights,lastEventName:null!==(n=e.last_event_name)&&void 0!==n?n:null,lastEventDate:null!==(l=e.last_event_date)&&void 0!==l?l:null}})}})(F,F?ec:void 0),[F,ec]),ef=(0,l.useMemo)(()=>F?new Map(F.nodes.map(e=>[e.fighter_id,e])):new Map,[F]);(0,l.useEffect)(()=>{T&&(ef.has(T)||L(null))},[ef,T]);let eg=(0,l.useMemo)(()=>F&&T?F.links.filter(e=>e.source===T||e.target===T).map(e=>{let t=e.source===T?e.target:e.source;return{fighter:ef.get(t),link:e}}).filter(e=>!!e.fighter).sort((e,t)=>t.link.fights-e.link.fights).slice(0,6):[],[F,ef,T]),eh=(0,l.useMemo)(()=>{var e;return F&&T&&null!==(e=ef.get(T))&&void 0!==e?e:null},[F,ef,T]),ex=(0,l.useCallback)(e=>{if(!e){L(null);return}ef.has(e)&&L(e)},[ef]),ep=Z&&!F;return(0,n.jsxs)("div",{className:"space-y-10",children:[ep?(0,n.jsx)("div",{className:"rounded-3xl border border-destructive/40 bg-destructive/10 px-4 py-3 text-sm text-destructive-foreground",role:"alert",children:Z}):null,(0,n.jsx)(et,{nodeCount:el,linkCount:ei,filters:y,fallbackLimit:x,insights:em}),(0,n.jsxs)("div",{className:"grid gap-6 xl:grid-cols-[360px,1fr]",children:[(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(z,{filters:y,onApply:V,onReset:X,availableDivisions:es,yearBounds:eo,isLoading:C,isRefreshing:R,error:Z,onRetry:()=>{_()}}),(0,n.jsx)(G,{sortBy:null!==(i=y.sortBy)&&void 0!==i?i:U,onChange:ee,disabled:C||R}),(0,n.jsx)($,{nodes:ec,onSelect:ex,onClear:()=>L(null)}),(0,n.jsx)(K,{insights:em,onSelectFighter:ex}),(0,n.jsx)(Q,{palette:ea,breakdown:em.divisionBreakdown})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(S,{data:F,isLoading:C||M,selectedNodeId:T,onSelectNode:L,palette:ea,nodeColorMap:eu}),(0,n.jsx)(J,{selectedNode:eh,connections:eg})]})]})]})}var ei=r(92590),es=r(63979);let eo={limit:150,includeUpcoming:!1,sortBy:U};function ea(){let[e,t]=(0,l.useState)(null),[r,i]=(0,l.useState)(null),[s,o]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{(async function(){try{let e=await (0,es.bZ)(eo);t(e)}catch(e){console.error("Failed to fetch fight graph:",e),i(e instanceof Error?e.message:"Unable to load the FightWeb network at this time.")}finally{o(!1)}})()},[]),(0,n.jsxs)("section",{className:"container flex flex-col gap-12 py-12",children:[(0,n.jsxs)("header",{className:"space-y-4",children:[(0,n.jsx)(ei.C,{variant:"outline",className:"w-fit tracking-[0.35em]",children:"Network"}),(0,n.jsx)("h1",{className:"text-4xl font-semibold tracking-tight md:text-5xl",children:"FightWeb"}),(0,n.jsx)("p",{className:"max-w-2xl text-lg text-muted-foreground",children:"Discover how UFC fighters are interconnected through shared bouts. The FightWeb network surfaces high-activity hubs, rivalries, and cross-division matchups in a single interactive view."})]}),s?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"text-lg text-muted-foreground",children:"Loading fight network..."})}):(0,n.jsx)(el,{initialData:e,initialFilters:eo,initialError:r})]})}},92590:function(e,t,r){"use strict";r.d(t,{C:function(){return s}});var n=r(41922),l=r(78235);let i={default:"bg-foreground text-background",outline:"border border-border text-foreground"};function s(e){let{className:t,variant:r="default",...s}=e;return(0,n.jsx)("span",{className:(0,l.cn)("inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-tight",i[r],t),...s})}},2581:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var n=r(41922),l=r(91115),i=r(78235);let s={default:"bg-foreground text-background hover:bg-foreground/90",outline:"border border-border bg-background text-foreground hover:bg-muted hover:text-foreground",ghost:"bg-transparent hover:bg-muted",link:"bg-transparent underline-offset-4 hover:underline"},o={default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"},a=(0,l.forwardRef)((e,t)=>{let{className:r,variant:a="default",size:d="default",type:u="button",asChild:c=!1,children:m,...f}=e,g=(0,i.cn)("inline-flex items-center justify-center rounded-full text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:pointer-events-none disabled:opacity-50",s[a],o[d],r);return c&&(0,l.isValidElement)(m)?(0,l.cloneElement)(m,{className:(0,i.cn)(g,m.props.className),ref:t,...f}):(0,n.jsx)("button",{ref:t,type:u,className:g,...f,children:m})});a.displayName="Button"},52711:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return s},aY:function(){return u},eW:function(){return c},ll:function(){return a}});var n=r(41922),l=r(91115),i=r(78235);let s=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("group/card relative rounded-3xl border border-border bg-card text-card-foreground shadow-sm transition-colors",r),...l})});s.displayName="Card";let o=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col gap-2 p-6 pb-0",r),...l})});o.displayName="CardHeader";let a=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("h3",{ref:t,className:(0,i.cn)("text-lg font-semibold tracking-tight",r),...l})});a.displayName="CardTitle";let d=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...l})});d.displayName="CardDescription";let u=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-4",r),...l})});u.displayName="CardContent";let c=(0,l.forwardRef)((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...l})});c.displayName="CardFooter"},15162:function(e,t,r){"use strict";r.d(t,{P:function(){return o}});var n=r(91115),l=r(17921),i=r(82696),s=r(63979);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{initialData:r=null,enabled:o=!0}=t,a=(0,n.useMemo)(()=>{var t,r,n,l;return["fight-graph",null!==(t=e.division)&&void 0!==t?t:null,null!==(r=e.startYear)&&void 0!==r?r:null,null!==(n=e.endYear)&&void 0!==n?n:null,null!==(l=e.limit)&&void 0!==l?l:null,!!e.includeUpcoming]},[e]);return(0,l.a)({queryKey:a,queryFn:()=>(0,s.bZ)(e),enabled:o,staleTime:12e4,refetchOnWindowFocus:!1,placeholderData:i.Wk,initialData:null!=r?r:void 0})}},78235:function(e,t,r){"use strict";r.d(t,{CO:function(){return d},Qm:function(){return i},T_:function(){return a},cn:function(){return l}});var n=r(63955);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.W)(t)}function i(e){var t,r;if(!e)return"";let n=e.trim().split(/\s+/).filter(Boolean);if(0===n.length)return"";if(1===n.length)return n[0].slice(0,2).toUpperCase();let l=null!==(t=n[0][0])&&void 0!==t?t:"",i=null!==(r=n[n.length-1][0])&&void 0!==r?r:"";return"".concat(l).concat(i).toUpperCase()}let s=["bg-blue-500/90 border-blue-500/50","bg-purple-500/90 border-purple-500/50","bg-amber-500/90 border-amber-500/50","bg-emerald-500/90 border-emerald-500/50","bg-rose-500/90 border-rose-500/50","bg-sky-500/90 border-sky-500/50","bg-indigo-500/90 border-indigo-500/50","bg-orange-500/90 border-orange-500/50"],o=new Map;function a(e){var t;let r=null!==(t=null==e?void 0:e.toLowerCase())&&void 0!==t?t:"",n=o.get(r);if(n)return n;if(!e)return o.set(r,s[0]),s[0];let l=0;for(let t=0;t<e.length;t+=1)l=(l<<5)-l+e.charCodeAt(t)|0;let i=Math.abs(l)%s.length,a=s[i];if(o.size>=512){let e=o.keys().next().value;o.delete(e)}return o.set(r,a),a}function d(e){var t;if(!e)return null;if(/^(?:[a-z]+:)?\/\//i.test(e)||e.startsWith("data:"))return e;let r=(t="https://ufc.wolfgangschoenberger.com/api","https://ufc.wolfgangschoenberger.com/api").replace(/\/+$/,""),n=e.replace(/^\/+/,"");return"".concat(r,"/").concat(n)}}},function(e){e.O(0,[8743,7043,1933,1688,9185,9358,7879,747,3979,2474,5633,1744],function(){return e(e.s=39548)}),_N_E=e.O()}]);